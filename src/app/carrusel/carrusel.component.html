<div id="carrusel" class="container my-4 text-white text-center">
    <h2 class="mb-3 fw-bold">Carrusel de Series</h2>
    <h4 class="lead mb-4">Agrega y arrastra las series para cambiar el orden</h4>

    <div cdkDropList (cdkDropListDropped)="reordenarCarrusel($event)"
        class="d-flex align-items-center flex-column rounded gap-2 p-3 mb-4 m-auto"
        style="width: fit-content; background-color: rgba(0, 0, 0, 0.2); border: solid 1px rgb(68, 76, 141);">
        <div *ngFor="let carrusel of carruselConSerie; let i = index" cdkDrag cdkDragHandle
            class="d-flex align-items-center gap-2 w-100 text-white"
            style="max-width: 440px; background-color: rgba(255,255,255,0.05); border-radius: 6px; padding: 0.5rem;">
            <div class="rounded bg-primary d-flex align-items-center justify-content-center"
                style="min-width: 2.2rem; min-height: 2.2rem;">
                {{ carrusel.posicion }}
            </div>
            <img [src]="carrusel.serie.banner || 'general/default-image-large.png'" [alt]="carrusel.serie.nombre"
                class="img-fluid"
                style="width: 100%; height: auto; object-fit: cover; aspect-ratio: 3/1;" />
            <button class="btn btn-danger" (click)="eliminarSerieDelCarrusel(i)">
                <i class="fa-solid fa-trash-can"></i>
            </button>
        </div>
    </div>
    <button class="btn btn-primary mb-3" (click)="agregarSerieAlCarrusel()">
        <i class="fa-solid fa-plus me-2"></i>Agregar Serie al Carrusel
    </button>
    <div class="d-flex justify-content-center mt-3 gap-2">
      <button class="btn btn-danger" (click)="cancelarCarrusel()">
        <i class="fa-solid fa-trash me-2"></i>Cancelar
      </button>
      <button class="btn btn-success" (click)="guardarOrdenCarrusel()">
        <i class="fa-solid fa-save me-2"></i>Guardar Orden
      </button>
    </div>
</div>

<!-- Modal para seleccionar series -->
<div class="modal fade" id="modalAgregarSerie" tabindex="-1" aria-labelledby="modalAgregarSerieLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg modal-dialog-centered">
    <div class="modal-content text-light" style="background-color: #1B1B3A;">
      <div class="modal-header" style="border-bottom: solid 1px rgba(255, 255, 255, 0.2);">
        <h5 class="modal-title fw-bold" id="modalAgregarSerieLabel">Seleccionar series para el carrusel</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-12 col-md-6 mb-3 text-center" *ngFor="let serie of seriesDisponibles">
            <div 
              class="position-relative w-100 d-flex flex-column align-items-center"
              [ngStyle]="seriesSeleccionadas.has(serie.id) ? {'border': '3px solid #198754', 'border-radius': '8px'} : {}"
            >
              <button type="button" class="p-0 border-0 w-100 bg-transparent text-white" (click)="toggleSeleccionSerie(serie)">
                <img [src]="serie.banner || 'general/default-image-large.png'" class="w-100" alt="banner">
                <span>{{ serie.nombre }}</span>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer" style="border-top: solid 1px rgba(255, 255, 255, 0.2);">
        <button class="btn btn-danger px-4" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn btn-success px-4" (click)="confirmarAgregarSeries()" data-bs-dismiss="modal" [disabled]="!seriesSeleccionadas.size">
          Agregar {{ seriesSeleccionadas.size }} serie(s)
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="modalAlerta" tabindex="-1" aria-labelledby="modalAlertaLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content">
            <div id="divHeader" class="modal-header px-3 py-2">
                <h5 class="modal-title" id="modalAlertaLabel">Mensaje</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body text-center p-2 py-3">
                <p id="modalMensaje" class="mb-0"></p>
            </div>
            <div class="modal-footer px-3 py-2">
                <button type="button" class="btn w-100" id="modalBoton" data-bs-dismiss="modal">Aceptar</button>
            </div>
        </div>
    </div>
</div>
